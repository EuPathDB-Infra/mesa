'use strict';var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=require('react'),_react2=_interopRequireDefault(_react),_PaginationUtils=require('../Utils/PaginationUtils'),_PaginationUtils2=_interopRequireDefault(_PaginationUtils),_Actions=require('../State/Actions');Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return call&&('object'==typeof call||'function'==typeof call)?call:self}function _inherits(subClass,superClass){if('function'!=typeof superClass&&null!==superClass)throw new TypeError('Super expression must either be null or a function, not '+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var SelectionCounter=function(_React$Component){function SelectionCounter(props){_classCallCheck(this,SelectionCounter);var _this=_possibleConstructorReturn(this,(SelectionCounter.__proto__||Object.getPrototypeOf(SelectionCounter)).call(this,props));return _this.selectAllRows=_this.selectAllRows.bind(_this),_this.deselectAllRows=_this.deselectAllRows.bind(_this),_this.goToSelection=_this.goToSelection.bind(_this),_this}return _inherits(SelectionCounter,_React$Component),_createClass(SelectionCounter,[{key:'noun',value:function noun(size){return size='number'==typeof size?size:size.length,'row'+(1===size?'':'s')}},{key:'selectAllRows',value:function selectAllRows(){var _props=this.props,dispatch=_props.dispatch,filteredRows=_props.filteredRows,ids=filteredRows.map(function(row){return row.__id});dispatch((0,_Actions.selectRowsByIds)(ids))}},{key:'deselectAllRows',value:function deselectAllRows(){var _props2=this.props,dispatch=_props2.dispatch,filteredRows=_props2.filteredRows,ids=filteredRows.map(function(row){return row.__id});dispatch((0,_Actions.deselectRowsByIds)(ids))}},{key:'goToSelection',value:function goToSelection(){var _props3=this.props,state=_props3.state,dispatch=_props3.dispatch,filteredRows=_props3.filteredRows,_state$uiState=state.uiState,selection=_state$uiState.selection,paginationState=_state$uiState.paginationState,paginate=state.options.paginate,spread=_PaginationUtils2.default.getSpread(filteredRows,paginationState,paginate),target=selection.find(function(id){return!spread.includes(id)});if(target){var targetIndex=filteredRows.findIndex(function(row){return row.__id===target});0>targetIndex||dispatch((0,_Actions.setPaginationAnchor)(targetIndex+1))}}},{key:'renderSelectionCount',value:function renderSelectionCount(){var _props4=this.props,state=_props4.state,dispatch=_props4.dispatch,filteredRows=_props4.filteredRows,selection=state.uiState.selection,allIds=filteredRows.map(function(row){return row.__id}),allSelected=_PaginationUtils2.default.isSpreadSelected(allIds,selection);return _react2.default.createElement('div',{className:'SelectionCounter'},allSelected?'All ':'',_react2.default.createElement('b',null,selection.length),' ',this.noun(selection),' ',allSelected?'are':'',' selected.',_react2.default.createElement('br',null),_react2.default.createElement('a',{onClick:this.deselectAllRows},'Clear selection.'))}},{key:'renderPaginatedSelectionCount',value:function renderPaginatedSelectionCount(){var _props5=this.props,state=_props5.state,dispatch=_props5.dispatch,filteredRows=_props5.filteredRows,_state$uiState2=state.uiState,selection=_state$uiState2.selection,paginationState=_state$uiState2.paginationState,allIds=filteredRows.map(function(row){return row.__id}),allSelected=_PaginationUtils2.default.isSpreadSelected(allIds,selection),spread=_PaginationUtils2.default.getSpread(filteredRows,paginationState,!0),pageCoverage=_PaginationUtils2.default.countSelectedInSpread(spread,selection),totalCoverage=_PaginationUtils2.default.countSelectedInSpread(allIds,selection),outsideCoverage=selection.length-pageCoverage,pageSelected=pageCoverage===spread.length;return _react2.default.createElement('div',{className:'SelectionCounter'},pageSelected&&!allSelected?_react2.default.createElement('span',null,'All ',_react2.default.createElement('b',null,pageCoverage),' ',this.noun(pageCoverage),' on this page are selected. '):null,!pageCoverage||pageSelected||allSelected?null:_react2.default.createElement('span',null,_react2.default.createElement('b',null,pageCoverage),' ',this.noun(pageCoverage),' selected on this page. '),outsideCoverage&&!allSelected?_react2.default.createElement('span',null,_react2.default.createElement('b',null,outsideCoverage),' ',this.noun(outsideCoverage),' selected on ',_react2.default.createElement('a',{onClick:this.goToSelection},'other pages'),'. '):null,allSelected?_react2.default.createElement('span',null,'All ',_react2.default.createElement('b',null,totalCoverage),' ',this.noun(totalCoverage),' are selected. '):null,_react2.default.createElement('br',null),pageSelected&&!allSelected?_react2.default.createElement('a',{onClick:this.selectAllRows},'Select all ',_react2.default.createElement('b',null,filteredRows.length),' ',this.noun(filteredRows.length),'. '):null,_react2.default.createElement('a',{onClick:this.deselectAllRows},'Clear selection.'))}},{key:'render',value:function render(){var paginate=this.props.state.options.paginate,selection=this.props.state.uiState.selection;return selection.length?paginate?this.renderPaginatedSelectionCount():this.renderSelectionCount():null}}]),SelectionCounter}(_react2.default.Component);exports.default=SelectionCounter;